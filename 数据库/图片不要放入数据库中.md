## 关于图片在服务器的存储机制
<a>http://www.cnblogs.com/wangtao_20/p/3440570.html</a>

商品图片，用户上传的头像，其他方面的图片。目前业界存储图片有两种做法：
 - 用二进制的方式存储到数据库中
 - 图片存储在磁盘上，数据库字段中保存的是图片的路径。

首先来讨论下第一种说法。

据社区的说法，互联网环境中，大访问量，数据库速度和性能方面很重要。一般在数据库存储图片的做法比较少，更多的是将图片路径存储在数据库中，展示图片的时候只需要连接磁盘路径把图片载入进来即可。因为图片是属于大字段。一张图片可能1m到几m。

有说法，三种东西不要放进数据库中，图片，文件和二进制数据。

<a>http://developer.51cto.com/art/201211/364472.htm</a>

理由是：

1. 对数据库的读/写的速度永远都赶不上文件系统处理的速度
2. 数据库备份变的巨大，越来越耗时间
3. 对文件的访问需要穿越你的应用层和数据库层

**因此，不建议把图片转成二进制数据存到数据库里，应该把它存到磁盘上，数据库中存放一个相对路径。**

### 数据库中保存图片路径
一般是这样子的：

按照年月日生成路径。具体是按照年月日还是按照年月去生成路径，根据自己需要(不一定是按照日期去生成)。

理解为什么要分散到多个文件夹中去才是关键，涉及到一个原理就明白了：

**操作系统对单个目录的文件数量是有限制的。当文件数量很多的时候。从目录中获取文件的速度就会越来越慢。所以为了保持速度，才要按照固定规则去分散到多个目录中去。**

图片分散到磁盘路径中去。数据库字段中保存的是类似于这样子的”images/2012/09/25/ 1343287394783.jpg”

有个方面总结一下：为什么保存的磁盘路径，是”images/2012/09/25/1343287394783.jpg”，而不是” /images/2012/09/25/ 1343287394783.jpg”(最前面带有斜杠)

这是因为为了以后的可扩展性，以后万一需要用到域名，则在程序中可以用字符串拼接来完成：域名+url